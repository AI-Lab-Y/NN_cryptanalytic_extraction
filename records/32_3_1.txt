true weights are 
[array([[-1.84551281, -0.96768992,  0.64799092, -0.04900044, -0.06220644,
         -0.86573807,  0.08953532,  0.5820179 ,  1.51856683,  0.9860407 ,
          2.5806608 , -0.35103851, -0.74400935,  1.73486844,  0.05035315,
         -0.76950304, -0.09480302, -0.82231746, -1.32828303,  0.05939889,
          0.94867036,  0.47628821,  0.50955588,  0.67937484, -0.1763914 ,
         -0.60263134,  0.31276603,  0.99499808, -0.34971055, -0.18604389,
         -0.34714865, -1.54173249],
        [-1.50097393, -0.80921933,  0.25027659,  1.84017694,  0.1797354 ,
         -0.09400555, -0.22162779,  0.57639827, -1.03194668, -0.03675383,
         -0.09162797,  0.9533002 , -0.94469354, -1.74358127, -0.5946664 ,
         -0.07964679, -1.34357385,  0.57409988, -1.29647861, -0.15907781,
         -1.31593333, -1.96026595,  0.36415597, -0.07196726, -0.6856687 ,
          0.40059519, -0.71851358,  0.65996615,  0.8118332 ,  0.26721323,
         -0.45719081, -0.72156692],
        [ 0.85026214, -0.69352052,  2.54636991,  0.99782291,  0.12410807,
         -0.49662616,  0.29852577, -0.65974837, -1.2554791 , -0.28269466,
         -1.02983147,  2.03994609, -0.65891634,  0.05344465, -0.59855885,
          2.37582315,  0.20378294,  1.64954253,  2.00163265, -0.60943819,
         -0.68934666, -0.06859834,  0.36342262, -0.67538321,  0.8290753 ,
         -1.23604345,  1.0027625 ,  1.85146397, -0.97819816,  0.82378833,
          0.82777806, -1.70217089]])
 array([[1.2325348 , 3.8356847 , 8.46760233]])]
true biases are 
[array([[-0.72648642],
        [-0.98923335],
        [ 0.7314195 ]]) array([[-7.29060507]])]
when the recovered model is correct: 
expected w_1s are: 
[-1.         -0.52434744  0.351117   -0.02655113 -0.03370686 -0.46910434
  0.04851514  0.3153692   0.82284275  0.5342909   1.39834348 -0.1902119
 -0.40314505  0.94004682  0.0272841  -0.41695892 -0.05136947 -0.44557668
 -0.71973656  0.03218557  0.5140416   0.25807906  0.27610531  0.36812253
 -0.09557853 -0.32653869  0.16947378  0.5391445  -0.18949234 -0.10080878
 -0.18810417 -0.83539517]
[-1.         -0.5391295   0.1667428   1.2259886   0.11974585 -0.0626297
 -0.14765599  0.38401617 -0.68751805 -0.02448665 -0.06104568  0.63512109
 -0.62938704 -1.16163328 -0.39618703 -0.05306341 -0.8951347   0.38248491
 -0.86375824 -0.10598306 -0.87671964 -1.305996    0.24261312 -0.04794704
 -0.45681586  0.26689017 -0.47869824  0.43969194  0.54087095  0.17802656
 -0.3045961  -0.48073248]
[ 1.         -0.81565494  2.99480571  1.17354739  0.14596448 -0.58408594
  0.35109851 -0.77593526 -1.47657886 -0.33247942 -1.2111929   2.39919667
 -0.7749567   0.06285667 -0.70396978  2.79422432  0.23967072  1.94003997
  2.35413592 -0.71676505 -0.81074604 -0.08067905  0.42742421 -0.79432352
  0.975082   -1.45372044  1.17935687  2.17752136 -1.15046656  0.96886395
  0.9735563  -2.00193659]
expected w_2 is: 
[2.73317697 6.91779282 8.65096979]
when we regard k-deep nn as a zero-deep nn: 
expected gamma_ps are: 
[-1.         -0.52434744  0.351117   -0.02655113 -0.03370686 -0.46910434
  0.04851514  0.3153692   0.82284275  0.5342909   1.39834348 -0.1902119
 -0.40314505  0.94004682  0.0272841  -0.41695892 -0.05136947 -0.44557668
 -0.71973656  0.03218557  0.5140416   0.25807906  0.27610531  0.36812253
 -0.09557853 -0.32653869  0.16947378  0.5391445  -0.18949234 -0.10080878
 -0.18810417 -0.83539517]
[-1.         -0.5391295   0.1667428   1.2259886   0.11974585 -0.0626297
 -0.14765599  0.38401617 -0.68751805 -0.02448665 -0.06104568  0.63512109
 -0.62938704 -1.16163328 -0.39618703 -0.05306341 -0.8951347   0.38248491
 -0.86375824 -0.10598306 -0.87671964 -1.305996    0.24261312 -0.04794704
 -0.45681586  0.26689017 -0.47869824  0.43969194  0.54087095  0.17802656
 -0.3045961  -0.48073248]
[ 1.         -0.81565494  2.99480571  1.17354739  0.14596448 -0.58408594
  0.35109851 -0.77593526 -1.47657886 -0.33247942 -1.2111929   2.39919667
 -0.7749567   0.06285667 -0.70396978  2.79422432  0.23967072  1.94003997
  2.35413592 -0.71676505 -0.81074604 -0.08067905  0.42742421 -0.79432352
  0.975082   -1.45372044  1.17935687  2.17752136 -1.15046656  0.96886395
  0.9735563  -2.00193659]
start step 1: collect decision boundary points
start step 2: recover $\gamma_P$s
5 different MAPs occur
corresponding \gamma_P are: 
boundary point: 0, \gamma_p is [[ 1.         -0.81565501  2.99480573  1.17354752  0.1459645  -0.58408603
   0.35109855 -0.77593537 -1.47657895 -0.33247945 -1.21119305  2.39919721
  -0.7749568   0.06285668 -0.70396986  2.79422444  0.23967075  1.94004031
   2.35413611 -0.71676511 -0.81074611 -0.08067906  0.42742426 -0.79432358
   0.97508214 -1.45372069  1.17935702  2.17752181 -1.15046671  0.96886402
   0.97355638 -2.00193669]]
boundary point: 2, \gamma_p is [[-1.         -0.53494318  0.218958    0.87126648  0.07628769 -0.17774426
  -0.09209987  0.36457519 -0.25978037  0.13376044  0.35225671  0.40138487
  -0.56531478 -0.56643262 -0.27625903 -0.15611946 -0.65617845  0.14797595
  -0.82297093 -0.06685338 -0.48285284 -0.86304635  0.25209818  0.06988482
  -0.35451262  0.09882974 -0.29513442  0.46785713  0.33403037  0.09905975
  -0.27160532 -0.58117378]]
boundary point: 5, \gamma_p is [[-1.         -0.53912952  0.1667428   1.22598859  0.11974585 -0.0626297
  -0.14765599  0.38401618 -0.68751805 -0.02448665 -0.06104568  0.6351211
  -0.62938705 -1.16163325 -0.39618704 -0.05306341 -0.8951347   0.38248492
  -0.86375825 -0.10598306 -0.87671964 -1.305996    0.24261312 -0.04794705
  -0.45681587  0.26689017 -0.47869824  0.43969194  0.54087096  0.17802657
  -0.3045961  -0.48073249]]
boundary point: 6, \gamma_p is [[-1.         -0.52434744  0.351117   -0.02655113 -0.03370686 -0.46910435
   0.04851514  0.3153692   0.82284278  0.5342909   1.39834345 -0.19021191
  -0.40314505  0.94004679  0.0272841  -0.41695893 -0.05136947 -0.44557668
  -0.71973654  0.03218557  0.5140416   0.25807906  0.27610531  0.36812253
  -0.09557853 -0.3265387   0.16947378  0.53914449 -0.18949235 -0.10080878
  -0.18810417 -0.83539518]]
boundary point: 23, \gamma_p is [[ -1.         -12.2189231   28.02111958  18.56088065   1.99898381
   -6.7683106    2.14848869  -3.19408747 -15.28097027  -1.58535081
   -7.0783741   24.62910203 -12.15996107  -4.92285091  -8.75618468
   22.66606091  -4.25937288  18.21132576  12.42309017  -6.845912
  -11.67373556  -9.02718143   6.13062465  -6.19720868   5.01401375
  -11.62228325   7.3542428   23.35295452  -6.72893227   9.33762816
    5.80094785 -22.92755662]]
5  true MAPs are  [[1], [6], [2], [4], [7]]
We have collected all the required queries
the Oracle query times is 2**16.305206759008723
start recover nn under a subset of decision boundary points
we have found a solution
the model activation patterns of selected points are  [[1], [2], [4], [7]]
selected w_2 sign is  1
recovered w_1 is  [[ 1.         -0.81565501  2.99480573  1.17354752  0.1459645  -0.58408603
   0.35109855 -0.77593537 -1.47657895 -0.33247945 -1.21119305  2.39919721
  -0.7749568   0.06285668 -0.70396986  2.79422444  0.23967075  1.94004031
   2.35413611 -0.71676511 -0.81074611 -0.08067906  0.42742426 -0.79432358
   0.97508214 -1.45372069  1.17935702  2.17752181 -1.15046671  0.96886402
   0.97355638 -2.00193669]
 [-1.         -0.53912952  0.1667428   1.22598859  0.11974585 -0.0626297
  -0.14765599  0.38401618 -0.68751805 -0.02448665 -0.06104568  0.6351211
  -0.62938705 -1.16163325 -0.39618704 -0.05306341 -0.8951347   0.38248492
  -0.86375825 -0.10598306 -0.87671964 -1.305996    0.24261312 -0.04794705
  -0.45681587  0.26689017 -0.47869824  0.43969194  0.54087096  0.17802657
  -0.3045961  -0.48073249]
 [-1.         -0.52434744  0.351117   -0.02655113 -0.03370686 -0.46910435
   0.04851514  0.3153692   0.82284278  0.5342909   1.39834345 -0.19021191
  -0.40314505  0.94004679  0.0272841  -0.41695893 -0.05136947 -0.44557668
  -0.71973654  0.03218557  0.5140416   0.25807906  0.27610531  0.36812253
  -0.09557853 -0.3265387   0.16947378  0.53914449 -0.18949235 -0.10080878
  -0.18810417 -0.83539518]]
recovered w_2 is  [[8.65096649 6.91779428 2.73317221]]
recovered bs are  [array([[ 0.86022776],
       [-0.65906226],
       [-0.39364738]]), array([[-8.76021371]])]
start checking the prediction matching ratio
prediction matching ratio is  1.0

we have found a solution
the model activation patterns of selected points are  [[1], [2], [4], [7]]
selected w_2 sign is  -1
recovered w_1 is  [[-1.          0.81565501 -2.99480573 -1.17354752 -0.1459645   0.58408603
  -0.35109855  0.77593537  1.47657895  0.33247945  1.21119305 -2.39919721
   0.7749568  -0.06285668  0.70396986 -2.79422444 -0.23967075 -1.94004031
  -2.35413611  0.71676511  0.81074611  0.08067906 -0.42742426  0.79432358
  -0.97508214  1.45372069 -1.17935702 -2.17752181  1.15046671 -0.96886402
  -0.97355638  2.00193669]
 [ 1.          0.53912952 -0.1667428  -1.22598859 -0.11974585  0.0626297
   0.14765599 -0.38401618  0.68751805  0.02448665  0.06104568 -0.6351211
   0.62938705  1.16163325  0.39618704  0.05306341  0.8951347  -0.38248492
   0.86375825  0.10598306  0.87671964  1.305996   -0.24261312  0.04794705
   0.45681587 -0.26689017  0.47869824 -0.43969194 -0.54087096 -0.17802657
   0.3045961   0.48073249]
 [ 1.          0.52434744 -0.351117    0.02655113  0.03370686  0.46910435
  -0.04851514 -0.3153692  -0.82284278 -0.5342909  -1.39834345  0.19021191
   0.40314505 -0.94004679 -0.0272841   0.41695893  0.05136947  0.44557668
   0.71973654 -0.03218557 -0.5140416  -0.25807906 -0.27610531 -0.36812253
   0.09557853  0.3265387  -0.16947378 -0.53914449  0.18949235  0.10080878
   0.18810417  0.83539518]]
recovered w_2 is  [[-8.65096649 -6.91779428 -2.73317221]]
recovered bs are  [array([[-0.86022776],
       [ 0.65906226],
       [ 0.39364738]]), array([[-8.76021371]])]
start checking the prediction matching ratio
prediction matching ratio is  0.314574

40 models are checked, and 2 extracted models are final candidates

Process finished with exit code 0
