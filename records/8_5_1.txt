true weights are 
[array([[-0.93265733, -0.37068592, -0.95014374,  1.5432912 ,  1.90274711,
         -0.10346679,  0.91794858,  0.430096  ],
        [-1.51969598, -0.68783623, -0.59447373, -0.366238  , -1.4074259 ,
          0.74542245, -1.4753117 , -0.19451977],
        [-0.18886435, -0.61086615, -0.34644385,  0.72680759,  2.19315872,
          1.8844221 ,  0.57858867,  1.98857221],
        [ 1.1351722 ,  1.16295002, -0.54094075, -1.18832224,  0.37349145,
          0.09716036,  0.50319303, -1.07799739],
        [ 0.52810139,  0.65547851, -0.15533596, -0.47435258,  0.61640581,
         -0.56606276, -0.49777228, -0.37827857]])
 array([[7.91301262, 8.20066151, 2.88259302, 3.11519365, 1.58225264]])]
true biases are 
[array([[-0.71918103],
        [ 0.03815997],
        [ 0.49395967],
        [-0.15593664],
        [ 0.0675548 ]]) array([[-8.61159195]])]
when the recovered model is correct: 
expected w_1s are: 
[-1.         -0.39745135 -1.01874902  1.65472478  2.04013526 -0.11093762
  0.98422919  0.46115115]
[-1.         -0.45261437 -0.39117938 -0.24099426 -0.92612333  0.49050762
 -0.97079398 -0.12799914]
[-1.         -3.23441741 -1.83435278  3.84830476 11.61234867  9.97764835
  3.06351443 10.52910289]
[ 1.          1.02447014 -0.47652748 -1.04682113  0.32901744  0.08559086
  0.44327463 -0.94963336]
[ 1.          1.24119823 -0.29414041 -0.89822255  1.16721112 -1.07188273
 -0.94256953 -0.71629913]
expected w_2 is: 
[0.4608206  0.77816827 0.03399392 0.22080795 0.05217483]
when we regard k-deep nn as a zero-deep nn: 
expected gamma_ps are: 
[-1.         -0.39745135 -1.01874902  1.65472478  2.04013526 -0.11093762
  0.98422919  0.46115115]
[-1.         -0.45261437 -0.39117938 -0.24099426 -0.92612333  0.49050762
 -0.97079398 -0.12799914]
[-1.         -3.23441741 -1.83435278  3.84830476 11.61234867  9.97764835
  3.06351443 10.52910289]
[ 1.          1.02447014 -0.47652748 -1.04682113  0.32901744  0.08559086
  0.44327463 -0.94963336]
[ 1.          1.24119823 -0.29414041 -0.89822255  1.16721112 -1.07188273
 -0.94256953 -0.71629913]
start step 1: collect decision boundary points
start step 2: recover $\gamma_P$s
29 different MAPs occur
corresponding \gamma_P are: 
boundary point: 0, \gamma_p is [[ 1.          0.62233343 -0.89703047 -0.53704454  2.50194751  1.91676426
   1.08139303  0.79351028]]
boundary point: 1, \gamma_p is [[-1.         -3.23441753 -1.83435284  3.84830511 11.61235359  9.97764767
   3.06351512 10.52910178]]
boundary point: 2, \gamma_p is [[-1.         -0.5923518  -1.07478123  1.80542448  2.69774941  0.58215151
   1.1270767   1.15282271]]
boundary point: 3, \gamma_p is [[-1.         -0.31750135 -0.90383273 -0.6208066  -0.35680484  1.26831739
  -1.11762434  0.02088586]]
boundary point: 4, \gamma_p is [[-1.         -0.39832091 -0.89475786  0.45113193  0.65279589  0.65450488
  -0.0949163   0.24819254]]
boundary point: 5, \gamma_p is [[-1.          0.17939632 -2.3943806   2.2139867   4.21972027 -0.13425626
   2.29751098  0.01175501]]
boundary point: 6, \gamma_p is [[ 1.          0.75744092 -0.76541069 -0.61589517  2.210555    1.26429838
   0.63953201  0.46389652]]
boundary point: 9, \gamma_p is [[-1.         -0.56904976 -0.45158497 -0.06983226 -0.40131215  0.88760208
  -0.80193369  0.31806531]]
boundary point: 11, \gamma_p is [[ 1.          1.02447012 -0.47652746 -1.0468211   0.32901742  0.08559086
   0.44327461 -0.9496333 ]]
boundary point: 13, \gamma_p is [[ 1.          1.06589309 -0.4416681  -1.01841968  0.48922028 -0.13563551
   0.1784001  -0.90503655]]
boundary point: 15, \gamma_p is [[-1.         -0.45261437 -0.39117937 -0.24099426 -0.92612332  0.49050761
  -0.97079394 -0.12799914]]
boundary point: 16, \gamma_p is [[-1.         -0.51587104 -1.23613894  1.91235812  3.15332032  0.52442596
   1.14882506  1.20427677]]
boundary point: 17, \gamma_p is [[-1.         -0.22606378 -0.73493648 -0.75118464 -1.16267713  0.71873898
  -1.17977985 -0.55492192]]
boundary point: 27, \gamma_p is [[-1.          0.5739882  -3.14115843  2.57946054  5.71602254 -0.46927983
   2.67386641 -0.18394292]]
boundary point: 31, \gamma_p is [[-1.         -0.39745136 -1.01874907  1.65472477  2.04013524 -0.11093762
   0.98422923  0.46115116]]
boundary point: 33, \gamma_p is [[-1.         -0.52290519 -0.50278064 -0.13629138 -0.34873143  0.87495072
  -0.92169769  0.29072565]]
boundary point: 34, \gamma_p is [[-1.         -0.39899862 -0.7981363  -0.48678364 -0.42830653  1.25098629
  -0.93585474  0.08224176]]
boundary point: 37, \gamma_p is [[-1.         -0.39594137 -0.44043113 -0.32286613 -0.90879715  0.44872605
  -1.1083013  -0.18867616]]
boundary point: 38, \gamma_p is [[-1.         -0.47554993 -0.69754418  0.53976676  0.55299842  0.50280571
  -0.20226402  0.35505649]]
boundary point: 47, \gamma_p is [[-1.         -0.12122216 -0.84121809 -0.92153308 -1.16220898  0.68226687
  -1.39897309 -0.68621182]]
boundary point: 58, \gamma_p is [[-1.         -0.24412964 -2.32490161  2.41674392  5.1368666   1.12025093
   2.39254263  1.31656233]]
boundary point: 65, \gamma_p is [[-1.         -0.506931   -0.6568987   0.55445852  0.48249341  0.52613005
  -0.15534155  0.36986248]]
boundary point: 75, \gamma_p is [[ 1.          1.24119827 -0.29414041 -0.89822254  1.16721116 -1.07188266
  -0.94256951 -0.71629911]]
boundary point: 102, \gamma_p is [[-1.         -0.5022166  -0.65689874  0.55445855  0.48249343  0.52613007
  -0.15534155  0.36986249]]
boundary point: 162, \gamma_p is [[-1.         -0.30363244 -0.86338778  0.33771087  0.28689032  0.34323397
  -0.20036658 -0.09505533]]
boundary point: 183, \gamma_p is [[-1.         -0.35434396 -0.95678851  0.4278051   0.74775449  0.63272833
  -0.14904696  0.22376917]]
boundary point: 184, \gamma_p is [[-1.         -0.43209741 -0.62459311  0.46408581  0.17712553  0.2668104
  -0.24365673  0.09112518]]
boundary point: 203, \gamma_p is [[-1.         -0.39652766 -0.66498254  0.44500026  0.23622539  0.23141774
  -0.29580572  0.06364122]]
boundary point: 208, \gamma_p is [[-1.         -0.28972395 -1.18637541  1.75131323  2.44964088 -0.26195707
   0.98954824  0.42857453]]
29  true MAPs are  [[6], [4], [20], [15], [30], [18], [7], [12], [2], [3], [8], [21], [10], [19], [16], [13], [14], [9], [29], [11], [22], [28], [1], [28], [26], [31], [24], [25], [17]]
We have collected all the required queries
the Oracle query times is 2**16.509218301622408
start recover nn under a subset of decision boundary points
we have found a solution
the model activation patterns of selected points are  [[4], [2], [8], [16], [1], [31]]
selected w_2 sign is  1
recovered w_1 is  [[-1.         -3.23441753 -1.83435284  3.84830511 11.61235359  9.97764767
   3.06351512 10.52910178]
 [ 1.          1.02447012 -0.47652746 -1.0468211   0.32901742  0.08559086
   0.44327461 -0.9496333 ]
 [-1.         -0.45261437 -0.39117937 -0.24099426 -0.92612332  0.49050761
  -0.97079394 -0.12799914]
 [-1.         -0.39745136 -1.01874907  1.65472477  2.04013524 -0.11093762
   0.98422923  0.46115116]
 [ 1.          1.24119827 -0.29414041 -0.89822254  1.16721116 -1.07188266
  -0.94256951 -0.71629911]]
recovered w_2 is  [[0.0339939  0.22080796 0.77816824 0.46082061 0.05217479]]
recovered bs are  [array([[ 2.61543033],
       [-0.13736951],
       [ 0.02510996],
       [-0.77111023],
       [ 0.12792359]]), array([[-0.53771375]])]
start checking the prediction matching ratio
prediction matching ratio is  1.0

we have found a solution
the model activation patterns of selected points are  [[4], [2], [8], [16], [1], [31]]
selected w_2 sign is  -1
recovered w_1 is  [[  1.           3.23441753   1.83435284  -3.84830511 -11.61235359
   -9.97764767  -3.06351512 -10.52910178]
 [ -1.          -1.02447012   0.47652746   1.0468211   -0.32901742
   -0.08559086  -0.44327461   0.9496333 ]
 [  1.           0.45261437   0.39117937   0.24099426   0.92612332
   -0.49050761   0.97079394   0.12799914]
 [  1.           0.39745136   1.01874907  -1.65472477  -2.04013524
    0.11093762  -0.98422923  -0.46115116]
 [ -1.          -1.24119827   0.29414041   0.89822254  -1.16721116
    1.07188266   0.94256951   0.71629911]]
recovered w_2 is  [[-0.0339939  -0.22080796 -0.77816824 -0.46082061 -0.05217479]]
recovered bs are  [array([[-2.61543033],
       [ 0.13736951],
       [-0.02510996],
       [ 0.77111023],
       [-0.12792359]]), array([[-0.53771375]])]
start checking the prediction matching ratio
prediction matching ratio is  0.182621

5700240 models are checked, and 2 extracted models are final candidates

Process finished with exit code 0
