true weights are 
[array([[-0.72456767, -0.15286669,  0.83697155,  0.49998896,  0.73567032,
          0.29798092, -0.30196247,  1.89687158],
        [ 0.91472897,  0.75851143, -0.04481941, -1.53801998,  0.75354953,
          0.16661832,  0.87908547, -0.62840743],
        [-0.66744658,  0.39487409, -0.45083324, -0.28838499,  2.49848669,
          0.06448956,  0.69366041,  0.32560361],
        [ 0.48255122, -0.18160828,  1.3579434 , -0.11642261, -0.14241074,
          0.56412642,  1.01216854, -1.55117593]])
 array([[0.46429706, 2.51093717, 3.4529423 , 5.45015016]])]
true biases are 
[array([[-0.65489984],
        [ 0.0021838 ],
        [-0.84000131],
        [ 0.07449225]]) array([[-8.12324205]])]
when the recovered model is correct: 
expected w_1s are: 
[-1.         -0.21097641  1.15513234  0.69005144  1.01532314  0.4112534
 -0.41674848  2.6179357 ]
[ 1.          0.82921986 -0.04899747 -1.6813942   0.82379541  0.18215048
  0.96103382 -0.68698757]
[-1.          0.59161902 -0.67545967 -0.43207202  3.74335083  0.09662131
  1.03927481  0.48783472]
[ 1.         -0.37635027  2.81409174 -0.24126478 -0.29512046  1.16904983
  2.09753597 -3.21453116]
expected w_2 is: 
[0.14718011 1.00485295 1.00827747 1.15060463]
when we regard k-deep nn as a zero-deep nn: 
expected gamma_ps are: 
[-1.         -0.21097641  1.15513234  0.69005144  1.01532314  0.4112534
 -0.41674848  2.6179357 ]
[ 1.          0.82921986 -0.04899747 -1.6813942   0.82379541  0.18215048
  0.96103382 -0.68698757]
[-1.          0.59161902 -0.67545967 -0.43207202  3.74335083  0.09662131
  1.03927481  0.48783472]
[ 1.         -0.37635027  2.81409174 -0.24126478 -0.29512046  1.16904983
  2.09753597 -3.21453116]
start step 1: collect decision boundary points
start step 2: recover $\gamma_P$s
13 different MAPs occur
corresponding \gamma_P are: 
boundary point: 0, \gamma_p is [[-1.          0.48938584 -0.44228213 -0.28913794  3.39585987  0.13669858
   0.85380911  0.75916311]]
boundary point: 1, \gamma_p is [[ 1.         -0.37635027  2.81409203 -0.24126478 -0.29512045  1.16904975
   2.09753593 -3.21453061]]
boundary point: 2, \gamma_p is [[ 1.          0.18567455  1.47934768 -0.9126387   0.226507    0.70896704
   1.56770965 -2.03621536]]
boundary point: 3, \gamma_p is [[ 1.          0.18382028  1.67242034 -0.92895158  0.31751671  0.79106448
   1.65206019 -1.99358296]]
boundary point: 5, \gamma_p is [[-1.         -0.21097641  1.15513232  0.69005141  1.01532305  0.41125338
  -0.41674845  2.61793556]]
boundary point: 6, \gamma_p is [[  1.           1.14866333  17.96467998  -5.01134135  24.13295739
   10.13536316  24.31945323 -22.53108188]]
boundary point: 10, \gamma_p is [[ 1.          0.93531296  0.14081972 -1.85151267  1.13939553  0.28398098
   1.05443541 -0.35562911]]
boundary point: 13, \gamma_p is [[ 1.          0.86885198  2.18590001 -2.09452944  3.71568704  1.41701343
   3.85903635 -3.39711474]]
boundary point: 16, \gamma_p is [[ -1.           9.28728756  -3.72016187 -13.43677102  31.54996212
    2.26409992  12.96267156   1.24072785]]
boundary point: 21, \gamma_p is [[-1.          0.59161903 -0.67545966 -0.43207203  3.74335106  0.09662131
   1.03927482  0.48783472]]
boundary point: 24, \gamma_p is [[ 1.          0.96567811  2.67763308 -2.30124089  4.41199695  1.68609773
   4.36567298 -3.51179438]]
boundary point: 36, \gamma_p is [[ 1.         -0.4624981   3.39628951 -0.17543775 -0.18948272  1.40084532
   2.34407042 -3.3020384 ]]
boundary point: 47, \gamma_p is [[ 1.          0.82921985 -0.04899747 -1.68139409  0.8237954   0.18215048
   0.96103377 -0.68698756]]
13  true MAPs are  [[10], [1], [5], [13], [8], [3], [12], [7], [14], [2], [15], [9], [4]]
We have collected all the required queries
the Oracle query times is 2**15.496354488564615
start recover nn under a subset of decision boundary points
we have found a solution
the model activation patterns of selected points are  [[1], [8], [2], [4], [15]]
selected w_2 sign is  1
recovered w_1 is  [[ 1.         -0.37635027  2.81409203 -0.24126478 -0.29512045  1.16904975
   2.09753593 -3.21453061]
 [-1.         -0.21097641  1.15513232  0.69005141  1.01532305  0.41125338
  -0.41674845  2.61793556]
 [-1.          0.59161903 -0.67545966 -0.43207203  3.74335106  0.09662131
   1.03927482  0.48783472]
 [ 1.          0.82921985 -0.04899747 -1.68139409  0.8237954   0.18215048
   0.96103377 -0.68698756]]
recovered w_2 is  [[1.15060597 0.14717742 1.00827968 1.00485112]]
recovered bs are  [array([[ 0.15435015],
       [-0.90354677],
       [-1.25855783],
       [ 0.00237445]]), array([[-3.55386669]])]
start checking the prediction matching ratio
prediction matching ratio is  0.999997

we have found a solution
the model activation patterns of selected points are  [[1], [8], [2], [4], [15]]
selected w_2 sign is  -1
recovered w_1 is  [[-1.          0.37635027 -2.81409203  0.24126478  0.29512045 -1.16904975
  -2.09753593  3.21453061]
 [ 1.          0.21097641 -1.15513232 -0.69005141 -1.01532305 -0.41125338
   0.41674845 -2.61793556]
 [ 1.         -0.59161903  0.67545966  0.43207203 -3.74335106 -0.09662131
  -1.03927482 -0.48783472]
 [-1.         -0.82921985  0.04899747  1.68139409 -0.8237954  -0.18215048
  -0.96103377  0.68698756]]
recovered w_2 is  [[-1.15060597 -0.14717742 -1.00827968 -1.00485112]]
recovered bs are  [array([[-0.15435015],
       [ 0.90354677],
       [ 1.25855783],
       [-0.00237445]]), array([[-3.55386669]])]
start checking the prediction matching ratio
prediction matching ratio is  0.50915

12870 models are checked, and 2 extracted models are final candidates

Process finished with exit code 0
